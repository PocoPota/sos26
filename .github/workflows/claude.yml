name: Claude Code

on:
  issue_comment:
    types: [created]
  pull_request_review_comment:
    types: [created]
  pull_request_review:
    types: [submitted]

permissions:
  id-token: write
  contents: write
  pull-requests: write
  issues: write

jobs:
  claude:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - uses: anthropics/claude-code-action@v1
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          claude_code_oauth_token: ${{ secrets.CLAUDE_CODE_OAUTH_TOKEN }}
          trigger_phrase: "@claude"
          claude_args: |
            --allowedTools "mcp__github__create_pending_pull_request_review,mcp__github__add_comment_to_pending_review,mcp__github__submit_pending_pull_request_review,mcp__github__get_pull_request_diff,Read,Glob,Grep,Bash(git diff:*)"
            --system-prompt "PRãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’ä¾é ¼ã•ã‚ŒãŸå ´åˆã¯ã€GitHubã®ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚³ãƒ¡ãƒ³ãƒˆæ©Ÿèƒ½ã‚’ä½¿ç”¨ã—ã¦ãƒ¬ãƒ“ãƒ¥ãƒ¼ã—ã¦ãã ã•ã„ã€‚æ‰‹é †ï¼š1. mcp__github__create_pending_pull_request_reviewã§ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’é–‹å§‹ 2. mcp__github__get_pull_request_diffã§diffæƒ…å ±ã‚’å–å¾— 3. mcp__github__add_comment_to_pending_reviewã§å„è¡Œã«ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã‚³ãƒ¡ãƒ³ãƒˆã‚’è¿½åŠ  4. mcp__github__submit_pending_pull_request_reviewã§COMMENTã‚¿ã‚¤ãƒ—ã¨ã—ã¦æå‡ºã€‚ãƒ¬ãƒ“ãƒ¥ãƒ¼è¦³ç‚¹ï¼šã‚³ãƒ¼ãƒ‰ã®å“è³ªã¨å¯èª­æ€§ã€TypeScriptã®å‹å®‰å…¨æ€§ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ï¼ˆXSSã€SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ç­‰ï¼‰ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã€CLAUDE.mdã®ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„ã¨ã®æ•´åˆæ€§ã€‚é‡è¦åº¦ï¼šğŸš¨ Criticalï¼ˆå¿…ãšä¿®æ­£ï¼‰ã€âš ï¸ Warningï¼ˆä¿®æ­£æ¨å¥¨ï¼‰ã€ğŸ’¡ Suggestionï¼ˆæ”¹å–„ææ¡ˆï¼‰ã€‚"
